<style type="text/css">

				@font-face {
					font-family: 'BBVA Web Light';
					src:url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-light/web-light.eot');
					src:url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-light/web-light.eot?iefix') format("embedded-opentype"),
						url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-light/web-light.woff') format("woff"),
						url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-light/web-light.ttf') format("truetype"),
						url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-light/web-light.svg#BBVA Web Light') format("svg");
					font-style: normal;
					font-weight: normal;
				}

				@font-face {
					font-family: 'BBVA Web Book';
					src:url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-book/web-book.eot');
					src:url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-book/web-book.eot?iefix') format("embedded-opentype"),
						url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-book/web-book.woff') format("woff"),
						url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-book/web-book.ttf') format("truetype"),
						url('https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/fonts/web-book/web-book.svg#BBVA Web Book') format("svg");
					font-style: normal;
					font-weight: normal;
				}

				.article-cover {
					display: table;
					width: 100%;
				}


				.article-cover.bordered-button {
					background-image: url(https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/img/border-bottom-shaded.png);
					background-position: bottom;
					background-repeat: repeat-x;
				}

				.article-cover .article-cover-wrapper {
				    margin-right: 20px;
					padding-left: 20px;
					width: 270px;
				}

				.article-cover .content-wrapper {
					display: table-cell;
					vertical-align: top;
				}

				.article-cover .media-wrapper {
					display: table-cell;
					vertical-align: middle;
				}

				#title {
		  			font-family: BBVA Web Book, Arial;
		  			font-size: 18px;
		  			font-weight: normal;
			      color: #0078D2;
		  			text-decoration: none;
		  			word-spacing: -2px;
		  			margin: 0;
				}

	      #subtitle {
					font-family: BBVA Web Light, Arial;
					font-size: 16px;
					font-weight: normal;
					text-transform: uppercase;
	    		word-spacing: 2px;
					color: #000;
					margin-top: 0;
					margin-bottom: 5px;
				}

				.author-signature {
					font-family: arial;
					font-size: 11px;
					color: #71777F;
					margin-top: 2px;
		  			margin-bottom: 19px;
				}

				p {
					font-family: arial;
					font-size: 13px;
					color: #434A58;
				}

				button {
					background: #0079C1;
					background: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAwNzljMSIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDU1OWQiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+');
					background: -moz-linear-gradient(top, #0079C1 0%, #00559D 100%);
					background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #0079C1), color-stop(100%, #00559D));
					background: -webkit-linear-gradient(top, #0079C1 0%, #00559D 100%);
					background: -o-linear-gradient(top, #0079C1 0%, #00559D 100%);
					background: -ms-linear-gradient(top, #0079C1 0%, #00559D 100%);
					background: linear-gradient(to bottom, #0079C1 0%, #00559D 100%);
					-webkit-border-radius: .3em;
					-moz-border-radius: .3em;
					border-radius: .3em;
					font-size: 11px;
					font-weight: bolder;
					word-spacing: 2px;
					height: 20px;
					padding-left: .9em;
					padding-right: .9em;
					border: .1em solid #00559D;
					color: white;
					cursor: pointer;
					margin: 20px 0;
				}

				button:hover {
					background: #004C99;
				}

				.cover-media {
				    text-align: right;  /* align the inline(-block) elements horizontally */
				    font: 0/0 a;         /* remove the gap between inline(-block) elements */
				}

				.container {
						text-align: center;
				}

				.cover-media:before {    /* create a full-height inline block pseudo=element */
				    content: ' ';
				    display: inline-block;
				    vertical-align: middle;  /* vertical alignment of the inline element */
				    height: 100%;
				}

				.cover-media img,
				.cover-media iframe {
				    display: inline-block;
				    vertical-align: middle;  /* vertical alignment of the inline element */
				    font: 16px/1 Arial sans-serif;        /* <-- reset the font property */
			        max-height: 100%;
	    			max-width: 300px;
	    			position: relative;
	    			bottom: 5px;
						padding-top: 5px;
				}

			</style>

			<script type="text/javascript" src="https://www.google.com/jsapi"></script>
			<script src="https://cdn.rawgit.com/sopraux/gsites/v1.0/newstycbbvaespana/js/jquery.min.js" type="text/javascript"></script>

			<!-- <script src="https://apis.google.com/js/platform.js" async defer></script>
			<meta name="google-signin-client_id" content="890384802796-6k5nag1u5pd1pu219s0341ceko4rd9ui.apps.googleusercontent.com">
			<div class="g-signin2" data-onsuccess="onSignIn"></div> -->

			<script>
			/*Not necessary. Currently, AJAX*/
	            // NOTE: You must replace the client id on the following line.
	            /*var clientId = '890384802796-6k5nag1u5pd1pu219s0341ceko4rd9ui.apps.googleusercontent.com';
							
	            var scopes = 'https://spreadsheets.google.com/feeds';

	            function init() {
	              gapi.auth2.authorize({client_id: clientId, scope: scopes, immediate: true},handleAuthResult);
	            }

	            function handleAuthResult(authResult) {
	              var authorizeButton = document.getElementById('authorize-button');
	              if (authResult && !authResult.error) {
	                authorizeButton.style.visibility = 'hidden';
	                ejecutarQuery();
	              } else {
	                authorizeButton.style.visibility = '';
	                authorizeButton.onclick = handleAuthClick;
	              }
	            }

	            function handleAuthClick(event) {
	              gapi.auth2.authorize(
	                  {client_id: clientId, scope: scopes, immediate: false},
	                  handleAuthResult);
	              return false;
	            }*/
	        </script>
 

			<script type="text/javascript">

				google.load('visualization', '1', {packages: ['table']});

			</script>
			<div id="container" class="container">
				<div id="not-found">
				</div>
		</div>

			<!--<button id="authorize-button" onclick=handleAuthClick(event)>Authorize</button>-->
		 	<div id="container" class="article-cover bordered-button">
		 		<div class="content-wrapper">
					<div class="article-cover-wrapper">

						<h3 id="subtitle"></h3>
			 			<h2 id="title"></h2>

						<div id="authorSignature"></div>

						<div id="sortDescription"></div>
						<button id="buttonArticle" type="button" onclick="javascript:goArticle()"></button>

					</div>
		 		</div>
		 		<div class="media-wrapper">

		 			<div id="coverMedia" class="cover-media"></div>

		 		</div>
		 	</div>

		 	<div id="functionsContainer"></div>

			<script type="text/javascript"> 
				$.ajax({
					  	url: 'https://raw.githubusercontent.com/sopraux/gsites/master/gsites-components/js/functionHelpers.js',
						success: function(result){
							var e = document.getElementById('functionsContainer');
				            /*e.innerHTML = '<scr'+'ipt id="sc1">'+result+'adjustGadgetHeight("container");</sc'+'ript>';*/
										e.innerHTML = '<scr' + 'ipt id="sc1">' + result + '</sc' + 'ript>';
				            eval(document.getElementById('sc1').innerHTML);
						}
					});

			</script>




			<script type="text/javascript">
		
					var dataForm = {
						'key': '1Iv72DC3co0yfP70TaxSxru6BFNfXkBjGss_8LMDwZ_Q',
						'numberTab': 1
					};
					
					$.ajax({
						type: 'GET',
						url: 'https://script.google.com/a/macros/bbva.com/s/AKfycbyPKcDJzBWVSlwWOugDVov87-_xXlEFfWXa7adIswtNXNtM-mdv/exec',
						data: dataForm,
						dataType: 'jsonp',
						crossDomain: true,
						jsonpCallback: "on_result",
						success: function (data) {
							//Eliminamos la primera fila ya que no es necesaria 
							data.splice(0, 1);

							data = getQueryParameters(data);
							handleQueryResponse(data);
						},
						error: function () {
							console.log('error');
						}
					});
					/*var prefs = new gadgets.Prefs(),
						spreadsheetKey = prefs.getString('spreadsheetKey'),
						siteName = prefs.getString('siteName'),
						sectionId = prefs.getString('sectionId'),
						date = getUrlParameter("date"),
						sheetName = encodeURIComponent('article content'),
						queryString = encodeURIComponent('SELECT * where A = "' + sectionId + '" and D ends with "' + date + '"'),
						query = new google.visualization.Query("https://docs.google.com/spreadsheets/d/" + spreadsheetKey + "/gviz/tq?sheet=" + sheetName + "&tq=" + queryString + "&access_token=" + encodeURIComponent(gapi.auth.getToken().access_token));
						query.send(handleQueryResponse);*/


				function ejecutarQuery() {

					function getUrlParameter(parameterName) {

						var params = gadgets.util.getUrlParameters()["parent"].split("?")[1].split('&');

						for (var i = 0; i < params.length; i++) {
							var p = params[i].split('=');
							if (p[0] == parameterName) {
								return decodeURIComponent(p[1]);
							}
						}
						return false;
					}
				}

					function isSearchDone() {
						/*if(gadgets.util.getUrlParameters().parent.split("=").length >= 2) {*/         //xml
						if (location.href.split("=").length >= 2) {                                     //local
							return true;
						}
						return false;
					}
					function getSelectedFirstValue(data) {  //return: id -> 'CAR'
						/*return gadgets.util.getUrlParameters().parent.split("=")[1].split("&")[0];*/     //xml
						lista = location.href.split("=")[1].split("&");                                   //local
						return lista;
					}

					function getSelectedSecondValue(data) {   //return: date= -> 07/2016
						/*return gadgets.util.getUrlParameters().parent.split("=")[2];*/              //xml
						listSecond = location.href.split("&")[1].split("&");                          //local
						listSecond = listSecond[listSecond.length - 1].split("=")[1].split("/");
						day = 1;
						return new Date(listSecond[1], listSecond[0], day);
					}

				 function getSelectedThirdValue(data) {   //return: key= 1uFsgtAioJmZlNeBKATb
						/*return gadgets.util.getUrlParameters().parent.split("=")[2];*/              //xml
						listThird = location.href.split("&")[2].split("=")[1];                        //local
						return listThird;
					}

					function getSelectedFourthValue(data) {   //return: siteName= -> canarias
						/*return gadgets.util.getUrlParameters().parent.split("=")[2];*/              //xml
						listFourth = location.href.split("&")[3].split("=")[1];                       //local
						return listFourth;
					}

					function getQueryParameters(data) {
						if (isSearchDone()) {

							var first = getSelectedFirstValue(data);               //return: 'CAR' 
							first = first[0].toLowerCase();

							var second = getSelectedSecondValue(data);             //return: '01/2016'

							var third = getSelectedThirdValue(data);							//return: '1uFsgtAioJmZlNeBK'

							var fourth = getSelectedFourthValue(data);						// return: 'canarias'

							data = data.filter(function (elem) {
								if (first == elem[0].toLowerCase()) {
									return true;
								}
							});

							data = data.filter(function (elem) {
								//GET DATE OF SPREEDSHEET
								//first Date: 
								var day = 1;
								var mon = elem[3].split("/")[1]; 
								var year = elem[3].split("/")[2];
								var firstDateSpreed1 = new Date(year, mon, day);

								//last Date:
								var day2 = 31;
								var firstDateSpreed2 = new Date(year, mon, day2);

								if (second >= firstDateSpreed1 && second <= firstDateSpreed2) {
									console.log("esta entre esas fechas");
									return true;
								}
							});

								/*window.parent.location.href = 'https://sites.google.com/a/bbva.com/newstycbbvaespana/articlecontent?id=' + first + '&date=' + second + '&key=' + third + '&siteName=' + fourth;
								return false;*/
						}
						return data;
					}

					function handleQueryResponse(data) {
						var html = "";
						if (!data.length) {
							/*console.log('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());*/
							console.log("Lo sentimos no hay noticias disponibles");
							html += '<p class="not-found">No hay ningún contenido disponible.</p>';
							document.getElementById('not-found').innerHTML = html;

							document.getElementById('buttonArticle').style.visibility="hidden";

							return;
						}
						var dataTable = data;
						dataTable.length ? printDataTable(dataTable) : console.log('spreadsheet is empty');
					}

					function printDataTable(dataTable) {
						var data = {
								title: dataTable[0][1],
								subtitle: dataTable[0][2],
								date: dataTable[0][3],
								author: dataTable[0][4],
								sortDescription: dataTable[0][7]
							},
							coverImage = dataTable[0][9],
							coverVideo = dataTable[0][10];


						if(coverImage != null && coverImage != undefined) {
							data.coverMedia = '<img src="' + coverImage + '" alt="image"/>';;
						} else if(coverVideo != null && coverVideo != undefined) {
							data.coverMedia = coverVideo;
						}

						document.getElementById("title").innerHTML = data.title;
						document.getElementById("subtitle").innerHTML = data.subtitle;

						if(data.author != null && data.author != undefined) {
							var authorSignature = '';
							authorSignature += '<p class="author-signature">';
							authorSignature += data.date + ' - ' + data.author;
							authorSignature += '</p>';
							document.getElementById("authorSignature").innerHTML = authorSignature;
						}

						document.getElementById("sortDescription").innerHTML = data.sortDescription;
						document.getElementById("coverMedia").innerHTML = data.coverMedia;

					}



					function goArticle(data) {

						var sectionId = getSelectedFirstValue(data);               //return: 'CAR' 
						sectionId = sectionId[0].toLowerCase();

						var date = getSelectedSecondValue(data);             //return: '01/2016'

						var spreadsheetKey = getSelectedThirdValue(data);							//return: '1uFsgtAioJmZlNeBK'

						var siteName = getSelectedFourthValue(data);						// return: 'canarias'


						window.parent.location.href = 'https://sites.google.com/a/bbva.com/newstycbbvaespana/articlecontent?id=' + encodeURIComponent(sectionId) + '&date=' + encodeURIComponent(date) + '&key=' + spreadsheetKey + '&siteName=' + siteName;
						return false;
					}

					//google.setOnLoadCallback(getSpreadsheet);

				/*	var buttonLabel = prefs.getString('buttonLabel');*/
					var buttonLabel = 'Más info';
					document.getElementById('buttonArticle').innerHTML = buttonLabel;
				

			</script>