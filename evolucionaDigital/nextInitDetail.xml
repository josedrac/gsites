<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  	<ModulePrefs title="NB-articleContent.xml">
	    <Require feature="idi"/>
	    <Require feature="locked-domain" />
		<Require feature="dynamic-height"/>
		<Require feature="setprefs" />
  	</ModulePrefs>

 	<Content type="html">
    	<![CDATA[

        <style type="text/css">

        @font-face {
            font-family: 'BBVA Web Light';
            src:url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-light/web-light.eot');
            src:url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-light/web-light.eot?iefix') format("embedded-opentype"),
            url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-light/web-light.woff') format("woff"),
            url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-light/web-light.ttf') format("truetype"),
            url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-light/web-light.svg#BBVA Web Light') format("svg");
            font-style: normal;
            font-weight: normal;
        }

        @font-face {
            font-family: 'BBVA Web Book';
            src:url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-book/web-book.eot');
            src:url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-book/web-book.eot?iefix') format("embedded-opentype"),
            url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-book/web-book.woff') format("woff"),
            url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-book/web-book.ttf') format("truetype"),
            url('https://cdn.rawgit.com/sopraux/gsites/v1.0/evolucionaDigital/fonts/web-book/web-book.svg#BBVA Web Book') format("svg");
            font-style: normal;
            font-weight: normal;
        }

        .container {
            float: left;
        }

        .header-container {
            border-bottom: 1px solid #DCDCDC;
            margin-top: 0;
            margin-bottom: 20px;
            float: left;
            width: 100%;
            padding-bottom: 7px;
        }

        .title {
            font-family: BBVA Web Light, Arial, 'Helvetica Neue', Helvetica, sans-serif;
            font-size: 22px;
            font-weight: normal;
            word-spacing: -1px;
            color: #0078D2;
            margin: 0;
            margin-left: 10px;
            float: left;
        }

        .status-round-container {
            float: right;
            font-family: BBVA Web Book, Arial, 'Helvetica Neue', Helvetica, sans-serif;
            font-size: 12px;
            margin-right: 10px;
        }

        .implementado {
            color: #3EB6B9;
        }

        .en-desarrollo {
            color: #C9CF42;
        }

        .analizando {
            color: #F6871E;
        }

        .rechazado {
            color: #C5175E;
        }

        .round, .status {
            display: inline-block;
            vertical-align: middle;
        }

        .image-container {
            text-align: center;
            margin: 25px 0;
        }

        .image {
            max-width: 100%;
        }

        p {
            font-family: BBVA Web Book, Arial, 'Helvetica Neue', Helvetica, sans-serif;
            font-size: 12px;
            color: #71777F;
            line-height: 19px;
        }

        .footer-container {
            background-color: #F5F5F5;
            border: 1px solid #DFE0DE;
            border-radius: 2px;
            height: 50px;
            padding: 12px 15px;
            margin-top: 25px;
        }

        .footer-content {
            display: table;
            height: 100%;
            float: left;
            font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;
        }

        .footer-content.right {
            float: right;
        }

        .footer-text {
            color: #0078D2;
            float: left;
        }

        .author {
            font-size: 11px;
            color: #71777F;
            margin-top: 1px;
            display: table-cell;
            vertical-align: bottom;
        }


        </style>

        <!-- --- END STYLES -------------------------------------------------------------------------------------- -->

        <!-- --- JAVASCRIPT -------------------------------------------------------------------------------------- -->

        <script src="https://www.google.com/jsapi" type="text/javascript"></script>
        <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="https://cdn.rawgit.com/sopraux/gsites/v1.0/gsites-components/js/functionHelpers.js" type="text/javascript"></script>

        <script type="text/javascript">

            google.load('visualization', '1', {packages: ['table']});

        </script>


        <div id="container" class="container">

            <div class="header-container">
                <h3 id="title" class="title"></h3>
                <div class="status-round-container">
                    <img class="round" src=""/>
                    <span id="status" class="status"></span>
                </div>
            </div>
            <div class="body-container">
                <p id="preImageText" class="text"></p>

                <div id="image_container" class="image-container"></div>

                <p id="postImageText" class="text"></p>
            </div>
            <div class="footer-container">
                <div class="footer-content">
                    <span id="footer-text" class="footer-text" ></span>
                </div>
                <div class="footer-content right">
                    <span id="author" class="author"></span>
                </div>
            </div>

        </div>


        <script type="text/javascript">

            adjustGadgetHeight('container');

			function getParam(p){
	            var params;
	            if(gadgets.util.getUrlParameters().parent.split("?").length > 1){
	                params = gadgets.util.getUrlParameters().parent.split("?")[1].split("&");
	                for(var i=0; i<params.length; i++){
	                    if(params[i].split("=")[0] == p)
	                        return params[i].split("=")[1];
	                }
	            }
	            return "";
	        }

            function isNull(value) {
                if(value !== null && value!== undefined && value!== "" && value.length > 0) return false;
                else                                                    return true;
            }

			var spreadsheetKey = '1o8qZcf1hFqxhmBxr8dqaYy3fmuyB8QFPyjRbxR7fkKI',
            sheetName = encodeURIComponent('archivo'),
            queryString = encodeURIComponent('SELECT * where A = "' + getParam("id") + '"'),
            query = new google.visualization.Query('https://spreadsheets.google.com/tq?key=' + spreadsheetKey + '&sheet=' + sheetName + '&tq=' + queryString);

            function getSpreadsheet() {
                query.send(handleQueryResponse);
            }

            function handleQueryResponse(response) {
                if (response.isError()) {
                    console.log('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                    return;
                }
                var dataTable = response.getDataTable();
                dataTable.getNumberOfRows() ? printDataTable(dataTable) : console.log('spreadsheet is empty');
            }

            function printDataTable(dataTable) {
                var data = {
                    title:          dataTable.getValue(0, 1),
                    preImageText:   dataTable.getValue(0, 4),
                    postImageText:  dataTable.getValue(0, 5),
                    author:         dataTable.getValue(0, 6),
                    status:         dataTable.getValue(0, 11),
                    footer:         dataTable.getValue(0, 13),
                },
                image = dataTable.getValue(0, 12);

                document.getElementById("title").innerHTML          =   data.title;
                document.getElementById("status").className         +=  " " + getStatusClass(data.status);
                document.getElementById("status").innerHTML         =   data.status;
                document.getElementById("preImageText").innerHTML   =   data.preImageText;

                if(!isNull(image))
                    document.getElementById("image_container").innerHTML    = '<img class="image" src="' + image + '"/>';
                if(!isNull(data.postImageText))
                    document.getElementById("postImageText").innerHTML      = data.postImageText;

                if(!isNull(data.footer))
                    document.getElementById('footer-text').innerHTML        = data.footer;
                if(!isNull(data.author))
                    document.getElementById("author").innerHTML             = data.author;

            }

            function Go(destination){
                window.open(destination,'_parent');
                return false;
            }

            function getStatusClass(status) {
                if      (status == 'Implementado')      return 'implementado';
                else if (status == 'En desarrollo')     return 'en-desarrollo';
                else if (status == 'Analizado')         return 'analizado';
                else                                    return 'rechazado';
            }

            google.setOnLoadCallback(getSpreadsheet);

        </script>

	    ]]>
	</Content>

</Module>
