<Module>
<ModulePrefs title="movilidadAppsCentral.xml" description="" author_affiliation="SopraGroup-UX">
<Require feature="idi"/>
<Require feature="locked-domain"/>
<Require feature="dynamic-height"/>
<Require feature="setprefs"/>
</ModulePrefs>
<UserPref name="_table_query_url" default_value="https://docs.google.com/spreadsheet/ccc?key=0AoYEewut2JmZdGdxMFFLY2JFWlc0REpyNUFaRFA3c2c" display_name="Data source url (Ej:https://docs.google.com/spreadsheet/ccc?key=0AoYEewut2JmZdGdxMFFLY2JFWlc0REpyNUFaRFA3c2c)" required="true"/>
<Content type="html"><![CDATA[

  <script src="https://www.google.com/jsapi" type="text/javascript"></script>

 <style type="text/css">
.container { max-width: 620px; margin: 0; padding: 0; width: 100%; font-family: 'BBVA Web Book'; }
.container .header { display: inline-block; width: 100%; }
.container .header h1.title { margin-top: 0; padding-left: 5px; font-weight: normal; color: #0078D2; font-family: BBVA Web Light, BBVA Web, Arial; font-size: 22px; margin: 16px 0px 16px 0px; display: inline-block; }
.container .header ul.oslist { float: right; text-align: center; padding-right: 15px; }
.container .header ul.oslist li { display: inline; list-style-type: none; padding-right: 10px; }
.container .header ul.oslist li img { width: 24px; display: inline-block; }
.container .header ul.oslist li span { display: inline-block; padding-left: 5px; vertical-align: super; font-size: 0.9em; }
.container .render .article { padding: 15px 5px 10px 5px; max-width: 184px; min-height: 280px; width: 32%; display: inline-block; vertical-align: top; margin: 5px; border: 1px solid  #DDE3EA; background: #ffffff; background: -moz-linear-gradient(top, white 0%, #f5f7f8 100%); background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, white), color-stop(100%, #f5f7f8)); background: -webkit-linear-gradient(top, white 0%, #f5f7f8 100%); background: -o-linear-gradient(top, white 0%, #f5f7f8 100%); background: -ms-linear-gradient(top, white 0%, #f5f7f8 100%); background: linear-gradient(to bottom, #ffffff 0%, #f5f7f8 100%); filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#f5f7f8',GradientType=0 ); }
.container .render .article .enlace { color: black; text-decoration: none; font-size: 1em; }
.container .render .article .enlace .articleimg { text-align: center; }
.container .render .article .enlace .articleimg img { margin: auto; width: 70px; }
.container .render .article .enlace h2 { text-align: center; font-size: 1em; font-family: 'BBVA Web Book'; }
.container .render .article .enlace ul.oslist { text-align: center; padding: 0; }
.container .render .article .enlace ul.oslist li { display: inline; list-style-type: none; padding-right: 10px; }
.container .render .article .enlace ul.oslist li .oslogo { width: 32px; }
.container .render .article .enlace div.short { text-align: left; padding: 10px; font-size: 11px; }
.container .render .article .enlace div.short span { color: #434A58; }



/* @group fonts */
@font-face { font-family: 'BBVA Web Book'; src: url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-book/web-book.eot");
      src: url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-book/web-book.eot?iefix") format("embedded-opentype"),
      url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-book/web-book.woff") format("woff"),
      url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-book/web-book.ttf") format("truetype"),
      url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-book/web-book.svg#BBVA Web Book") format("svg"); font-style: normal; font-weight: normal; }

@font-face { font-family: 'BBVA Web Light'; src: url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-light/web-light.eot");
      src: url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-light/web-light.eot?iefix") format("embedded-opentype"),
      url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-light/web-light.woff") format("woff"),
      url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-light/web-light.ttf") format("truetype"),
      url("https://bbvaportaldeayuda.googlecode.com/svn/trunk/fonts/web-light/web-light.svg#BBVA Web Light") format("svg"); font-style: normal; font-weight: normal; }
</style>
<!--[if lt IE 9]>
<style>
.container .header{padding-bottom:15px;}
.container .header h1.title { margin:0; display: inline; }
.container .header ul.oslist{ position:absolute; right:0; top:0; margin:0; display: inline; }
img {border:none;}
.container .render .article .enlace ul.oslist { text-align: none; margin:0; padding: 0; }
.container .render .article_ie
{ max-width: 180px;height: 300px;width: 32%;display: inline;}
</style>
<![endif]-->
<body onload="cargaCompleta()">
<div class="container">
<div class="header">
			<h1 class="title">Apps de BBVA</h1>
			<ul class="oslist">
				<li><img src="https://bbvaportaldeayuda.googlecode.com/svn/trunk/fase2/img/iphone.png">
				<span>Iphone</span></li>
				<li><img src="https://bbvaportaldeayuda.googlecode.com/svn/trunk/fase2/img/ipad.png">
				<span>Ipad</span></li>
				<li><img src="https://bbvaportaldeayuda.googlecode.com/svn/trunk/fase2/img/android.png">
				<span>Android</span></li>
        <li><img src="https://raw.githubusercontent.com/sopraux/gsites/master/bbvaportaldeayuda/fase2/img/tablet.png">
        <span>Tablet</span></li>
			</ul>
 </div>
<div id="render" class="render"><div>
</div>
<script type="text/javascript">
     var gadgetHelper = null;
         var prefs = new _IG_Prefs();
         var urlTable = prefs.getString("_table_query_url");
         _IG_RegisterOnloadHandler(loadVisualizationAPI);

         function loadVisualizationAPI() {
                google.load("visualization", "1", {"packages": ["table"]});
        }

        function reload(){
                var gadgetHelper = new google.visualization.GadgetHelper();
                var opts = {dataType:'jsonp'};
                var queryDC = new google.visualization.Query(urlTable, opts);

                var queryDCtosend = "select A,B,C,D,E,F order by A";

                queryDC.setQuery(queryDCtosend);
                queryDC.send(handleQueryResponseDC);

        }

        var DataTable= function(data){
                var HEADER_ROW = 0;
                var FIELDS = {
                        id : 0,
                        title : 1,
                        type: 2,
                        image: 3,
                        short: 4,
                        long:5
                };

                var URL_DETAIL = "https://sites.google.com/a/bbva.com/portaldeayuda/movilidad/app_detail?app_id=";

                var dataDC = data;
                this.getNumberOfRows = function(){
                        return dataDC.getNumberOfRows();
                }
                this.getId = function(row){
                        return dataDC.getValue(row, FIELDS.id);
                }
                this.getTitle = function(row){
                        return dataDC.getValue(row, FIELDS.title);
                }
                this.getImage = function(row){
                        return dataDC.getValue(row, FIELDS.image);
                }
                this.getType= function(row){
                        var icons = (dataDC.getValue(row, FIELDS.type)).split(/[ ,]+/);
                        return icons;
                }
                this.getShort= function(row){
                        return dataDC.getValue(row, FIELDS.short);
                }
                this.getLong= function(row){
                        return dataDC.getValue(row, FIELDS.long);
                }

                this.getUrlDetalle= function(row){
                        return URL_DETAIL+this.getId(row);
                }

                this.isHeaderTable = function(row){
                        return ( row == HEADER_ROW);
                }

        }

        function handleQueryResponseDC(response){
                var dataDC = new DataTable(response.getDataTable());
                var filas = dataDC.getNumberOfRows();
                var html= "";
                var renderIcons = function(types)
                {
                  var URLICONS =
                              {
                              "Android":"https://bbvaportaldeayuda.googlecode.com/svn/trunk/fase2/img/android.png",
                              "Iphone":"https://bbvaportaldeayuda.googlecode.com/svn/trunk/fase2/img/iphone.png",
                              "Ipad":"https://bbvaportaldeayuda.googlecode.com/svn/trunk/fase2/img/ipad.png",
                              "Tablet":"https://raw.githubusercontent.com/sopraux/gsites/master/bbvaportaldeayuda/fase2/img/tablet.png"
                              };

                  var iconshtml="";
                  for(n in types)
                  {
                   iconshtml += "<li class=\"oslist\"><img src=\""+URLICONS[types[n]]+"\"></li>";
                  }
                  return iconshtml;
                }
                for(var row=0;row<filas;row++){

                    html +="<div class=\"article article_ie\"><a class=\"enlace\" target=\"_parent\" href=\""+dataDC.getUrlDetalle(row)+"\">";
                    html +="<div class=\"articleimg\"><img src='"+dataDC.getImage(row)+"'></div>";
                    html +="<h2>"+dataDC.getTitle(row)+"</h2>";
                    html +="<ul class=\"oslist\">"+renderIcons(dataDC.getType(row))+"</ul>";
                    html +="<div class=\"short\"><span>"+dataDC.getShort(row)+"</span></div>";
                    html +="</a></div>";

                }


                document.getElementById('render').innerHTML = html;

        }

        function cargaCompleta(){
                reload();
        }

</script>
</body>



  ]]></Content>
</Module>
