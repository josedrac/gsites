<script src="https://www.google.com/jsapi" type="text/javascript"></script>
	<script src="https://rawgit.com/sopraux/gsites/master/evolucionaDigital/js/jquery.min.js" type="text/javascript"></script>
	<script src="https://rawgit.com/sopraux/gsites/master/gsites-components/js/functionHelpers.js" type="text/javascript"></script>	

	<style type="text/css">
	  	/* @group fonts */
		@font-face {
			font-family: 'BBVA Web Light';
			src:url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-light/web-light.eot');
			src:url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-light/web-light.eot?iefix') format("embedded-opentype"),
				url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-light/web-light.woff') format("woff"),
				url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-light/web-light.ttf') format("truetype"),
				url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-light/web-light.svg#BBVA Web Light') format("svg");
			font-style: normal;
			font-weight: normal;
		}
		@font-face {
			font-family: 'BBVA Web Book';
			src:url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-book/web-book.eot');
			src:url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-book/web-book.eot?iefix') format("embedded-opentype"),
				url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-book/web-book.woff') format("woff"),
				url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-book/web-book.ttf') format("truetype"),
				url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-book/web-book.svg#BBVA Web Book') format("svg");
			font-style: normal;
			font-weight: normal;
		}
		@font-face {
			font-family: 'BBVA Web Medium';
			src:url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-medium/web-medium.eot');
			src:url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-medium/web-medium.eot?iefix') format("embedded-opentype"),
				url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-medium/web-medium.woff') format("woff"),
				url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-medium/web-medium.ttf') format("truetype"),
				url('https://github.com/sopraux/gsites/raw/master/evolucionaDigital/fonts/web-medium/web-medium.svg#BBVA Web Medium') format("svg");
			font-style: normal;
			font-weight: normal;
		}
		/* @end */

		.title{
            background: #ffffff; /* Old browsers */
            background: -moz-linear-gradient(top,  #ffffff 0%, #f5f7f8 100%); /* FF3.6+ */
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#f5f7f8)); /* Chrome,Safari4+ */
            background: -webkit-linear-gradient(top,  #ffffff 0%,#f5f7f8 100%); /* Chrome10+,Safari5.1+ */
            background: -o-linear-gradient(top,  #ffffff 0%,#f5f7f8 100%); /* Opera 11.10+ */
            background: -ms-linear-gradient(top,  #ffffff 0%,#f5f7f8 100%); /* IE10+ */
            background: linear-gradient(to bottom,  #ffffff 0%,#f5f7f8 100%); /* W3C */
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#f5f7f8',GradientType=0 ); /* IE6-9 */
            border-bottom: 1px solid #DDE3EA;
            color: #333333;
            font-family: BBVA Web Book,Arial;
            font-size: 16px;
            padding-bottom: 15px;
            padding-left: 18px;
            padding-top: 14px;
        }
        .subtitle {
            color: #0078d2;
            font-weight: bold;
            text-align: center;
            background-color: #f4f4f4;
            padding: 10px 0;
            border-top: 1px solid #DDE3EA;
        }

        .btn:hover {
            background: #004C99;
        }

        .btn {
            background: #0079C1;
            background: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJo…iIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+');
            background: -moz-linear-gradient(top, #0079C1 0%, #00559D 100%);
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#0079C1), color-stop(100%,#00559D));
            background: -webkit-linear-gradient(top, #0079C1 0%,#00559D 100%);
            background: -o-linear-gradient(top, #0079C1 0%,#00559D 100%);
            background: -ms-linear-gradient(top, #0079C1 0%,#00559D 100%);
            background: linear-gradient(to bottom, #0079C1 0%,#00559D 100%);
            -webkit-border-radius: .1em;
            -moz-border-radius: .1em;
            border-radius: .1em;
            text-align: center;
            font-size: 13px;
            vertical-align: middle;
            height: 1.75em;
            padding-left: 2em;
            padding-right: 2em;
            padding-bottom: 2px;
            border: .1em solid #00559D;
            color: white;
            cursor: pointer;
            position: relative;
            text-align: center;
            vertical-align: middle;
            margin-left: 0px;
            margin-right: 0px;
        }
        select {
            width:220px;
        }
        .ui-widget-content {
            background: white;
        }
        
        .ui-selectmenu-button.ui-state-hover, .ui-selectmenu-button.ui-state-focus {
            color: #0078d2;
        }
        .ui-state-hover, .ui-widget-content .ui-state-hover, .ui-widget-header .ui-state-hover, .ui-state-focus, .ui-widget-content .ui-state-focus, .ui-widget-header .ui-state-focus  {
            background: #e2fafe none repeat scroll 0 0;
            color: #003f8c;
            border: 1px solid #e1e1e1;
        }
        .ui-widget-content {
            border: 1px solid rgb(213, 226, 238);
            color: rgb(34, 34, 34);
        }
        .ui-state-hover,.ui-widget-content .ui-state-hover,.ui-widget-header .ui-state-hover,.ui-state-focus,.ui-widget-content .ui-state-focus,.ui-widget-header .ui-state-focus {
            background-image: none;
        }
        
        .ui-state-default .ui-icon {
            border: 0;
            border-left: 1px solid #d2e5eb;
            background: url('https://rawgit.com/sopraux/gsites/master/evolucionaDigital/img/ico-combo30.png'), linear-gradient(to bottom, #ffffff 40%, #d2e5eb 200%);
            background-position: 3px 0px;
            width: 35px;
            height: 30px;
            position: absolute;
            top: 0;
            right: 0;
        }
        
        .name {
            color: #434a58;
            float: left;
            font-family: Arial;
            font-size: 13px;
            margin-left: 15px;
            margin-right: 10px;
            padding-top: 10px;
            font-weight: bold;
            display: inline-block;
            width: 30px;
        }
        

	</style>


	<div class="container">
        <div class="title">Histórico de Publicaciones</div>
        <div class="form">
            <div class="element-year">
                <label class="name">Año: </label>
                
            </div> 
        </div>
        <div class="subtitle">
            <button onclick='javascript:Go();' class="btn">Ver</button>
        </div>
    </div>
    </div>

   	<script type="text/javascript">
   		
   		adjustGadgetHeight('container');
		var gadgetHelper = null;
		var dataUser;
		var eventDate;
		google.load('visualization', '1', {packages: ['table']});
        google.setOnLoadCallback(sendQuery);
        google.setOnLoadCallback(sendQueryUsers);
        google.setOnLoadCallback(sendQueryDocs);
        var prefs = new gadgets.Prefs();


	 	function loadVisualizationAPI() {
			google.load("visualization", "1", {"packages": ["table"]});
			google.setOnLoadCallback(sendQuery);
		}

	    function getParam(p){
            var params;
            //if(location.href.split("?").length > 1){
            if(gadgets.util.getUrlParameters().parent.split("?").length > 1){
                params = gadgets.util.getUrlParameters().parent.split("?")[1].split("&");
                //params = location.href.split("?")[1].split("&");
                for(var i=0; i<params.length; i++){
                    if(params[i].split("=")[0] == p)
                        return params[i].split("=")[1];
                }
            }
            return "";
        }

        function getQueryParameters() {
            var filter = "";

            var id = getParam('id');

            if(id != "" && id > 0)
            	filter += " AND A ="+ id;

            return filter;
        }

		function sendQuery(){
			var spreadsheetKey = prefs.getString('spreadsheetKey'),
			//var spreadsheetKey = '1hZ2TFoq3ihf7d9lVT7hx3P3cSui7kaG5s7zR781GnL8',
                sheetName = encodeURIComponent('events'),
                queryString = encodeURIComponent('SELECT * where B <> "title"' + getQueryParameters()),
                query = new google.visualization.Query('https://spreadsheets.google.com/tq?key=' + spreadsheetKey + '&sheet=' + sheetName + '&tq=' + queryString);
                query.send(function (response) {
                	handleQueryResponse(response, 0);
            	});
		}


		function handleQueryResponse(response, index) {
			data = response.getDataTable();
			
			if(index == 0){
				eventDate = data.getFormattedValue(0, 5);
				if(eventDate == 'undefined' || eventDate == null || eventDate == '')
					eventDate = data.getFormattedValue(0, 4);

				var title = data.getValue(0, 1);
				var address = data.getValue(0, 7);
				var contact = data.getValue(0, 8);
				var contactEmail = data.getValue(0, 9);
				var schedule = data.getValue(0, 10);
				var transport = data.getValue(0, 11);
				var web = data.getValue(0, 12);

				var description = data.getValue(0, 2);

				var tagConfirm = "";
					
				document.getElementById('title').innerHTML = title;
				document.getElementById('place').innerHTML = address;
				document.getElementById('contactName').innerHTML = contact;
				document.getElementById('contactEmail').innerHTML = contactEmail;
				document.getElementById('schedule').innerHTML = schedule;
				document.getElementById('transport').innerHTML = transport;
				document.getElementById('web').innerHTML = web;
				document.getElementById('description').innerHTML = description;

				
			}
			else if(index == 1){
				dataUser = data;
				isAssistant(dataUser);
				var filas = data.getNumberOfRows();
				html = "";
				for(var i=0; i<filas; i++) {

					var date = data.getFormattedValue(i, 3);
					var name = data.getValue(i, 1);
					html += "<span class='assistant'>"+ date +" - Asistente "+ name +"</span>";
				}
				
				document.getElementById('assistants').innerHTML = html;
			}
			else {
				var filas = data.getNumberOfRows();
				html = "";
				html += '<span class="header">Documentación:</span>';
				for(var i=0; i<filas; i++){
					html += '<div class="docContent">';
					html += '	<img class="icon" src="https://raw.githubusercontent.com/sopraux/gsites/master/actividadtyc/img/pdf.png"/>';
					html += '	<a class="docLink" href="'+data.getValue(i, 2)+'">'+data.getValue(i, 1)+'</a>';
					html += '</div>';
				}
				document.getElementById('docsContainer').innerHTML = html;
			}

		}

		

	    function Go(destination){
	    	window.open(destination,'_blank');
		    //window.parent.location.href = destination;
		    return false;
		}

		//delay loading
		delayRender();
	    function delayRender(){
	    	window.setTimeout('showIframes()', 2000);
	    }

	 	function showIframes() {
		 	var iframes =document.getElementsByClassName('youtubeIframe').length;
		 	for (var i=0;i<iframes;i++) {
				document.getElementsByClassName('youtubeIframe')[i].style.display='block';
			}
	 	}

  	</script>